<script>
  var myList = [
    {
      documentNumber: "08179943437",
      registerName: "Anna Cecilia dos Santos Mangueira",
      socialName: "",
      birthDate: "1990/02/14",
      motherName: "CRISTIANA FRANCISCA DOS SANTOS",
      email: "anna@bitrecife.com.br",
    },
    {
      documentNumber: "05812979464",
      registerName: "DESSIDERIO ANTONIO DO MONTE JUNIOR",
      birthDate: "1986/01/06",
      motherName: "CELESTE MARIA VIDEIRA DO MONTE",
      email: "dessiderio@bitrecife.com.br",
    },
  ];

  // Builds the HTML Table out of myList.
  function buildHtmlTable(selector) {
    var columns = addAllColumnHeaders(myList, selector);

    for (var i = 0; i < myList.length; i++) {
      var row$ = $("<tr/>");
      for (var colIndex = 0; colIndex < columns.length; colIndex++) {
        var cellValue = myList[i][columns[colIndex]];
        if (cellValue == null) cellValue = "";
        row$.append($("<td/>").html(cellValue));
      }
      $(selector).append(row$);
    }
  }

  // Adds a header row to the table and returns the set of columns.
  // Need to do union of keys from all records as some records may not contain
  // all records.
  function addAllColumnHeaders(myList, selector) {
    var columnSet = [];
    var headerTr$ = $("<tr/>");

    for (var i = 0; i < myList.length; i++) {
      var rowHash = myList[i];
      for (var key in rowHash) {
        if ($.inArray(key, columnSet) == -1) {
          columnSet.push(key);
          headerTr$.append($("<th/>").html(key));
        }
      }
    }
    $(selector).append(headerTr$);

    return columnSet;
  }
  function parseJson() {
    var jsonText = document.getElementById("jsonInput").value;
    var jsonData = JSON.parse(jsonText);
    var companyArray = []
   // var jsonData = addressParse(jsonData);
    //var owners_data = json_data.owners;
    //companyData = parseCompanyData(jsonData);
    var companyAdress = addressParse(jsonData);

    jsonData.owners.forEach(phoneParse);
    jsonData.owners.forEach(addressParse);
    
    jsonData.legalRepresentatives.forEach(addressParse);
    jsonData.legalRepresentatives.forEach(phoneParse);
    
    buildTable(jsonData.owners,"#table_owners");
    delete jsonData.owners

    buildTable(jsonData.legalRepresentatives,"#table_legalRepresentatives");
    delete jsonData.legalRepresentatives
    companyArray.push(jsonData)

    buildTable(companyArray,"#table_company");

  }


  
  function phoneParse(register) {
    register.phone = register.phone.countryCode + register.phone.number;
    return register.phone;
  }

  function addressParse(register) {
    register.address =  register.address.addressLine + ',' + register.address.buildingNumber + ' - ' + 
                        register.address.complement + ' ' + 
                        register.address.neighborhood + ' ' + register.address.city + ' ' + register.address.state + ' - ' + register.address.country;

    return register.address;
  }
  
  function buildTable(data,selector) {
    myList = data;
    buildHtmlTable(selector);
  }

  function parseCompanyData(companyData){
      console.log(companyData)
    companyData = addressParse(companyData)
    
    return companyData
  }


</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://unpkg.com/purecss@2.0.6/build/pure-min.css" integrity="sha384-Uu6IeWbM+gzNVXJcM9XV3SohHtmWE+3VGi496jvgX1jyvDTXfdK+rfZc8C1Aehk5" crossorigin="anonymous">
<body>
  <textarea id="jsonInput" name="jsonInput" rows="4" cols="50"></textarea>
  <button value="dataView" id="dataView" onclick="parseJson()">
    Parse JSON
  </button>
  <!--<button value="parseJson" id="geraDados" onclick="buildHtmlTable('#jsonInput')"> Gerar Dados</button> -->
  <div>
    OWNERS
    <table class="pure-table pure-table-bordered" id="table_owners" border="1"></table>
  </div>
  <div>
    LEGAL REPRESENTATIVES
    <table class="pure-table pure-table-bordered" id="table_legalRepresentatives" border="1"></table>
  </div>

  <div>
    COMPANY
    <table class="pure-table pure-table-bordered" id="table_company" border="1"></table>
  </div>

</body>
